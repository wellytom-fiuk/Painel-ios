<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Project X Red v5.0 - OB52 A23</title>

  <!-- PWA: Configurações neutras -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#e60000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Project X Red">
  <link rel="apple-touch-icon" href="https://via.placeholder.com/512?text=PXR">

  <style>
    :root {
      --primary: #e60000;
      --primary-dark: #b30000;
      --primary-glow: rgba(230, 0, 0, 0.5);
      --bg: #121212;
      --card: rgba(30, 30, 30, 0.9);
      --text: #f5f5f5;
      --text-muted: #bbbbbb;
      --accent: #ff4d4d;
      --success: #4caf50;
      --error: #f44336;
      --warning: #ff9800;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow-x: hidden;
    }

    #particles-js { position: fixed; inset: 0; z-index: 0; }

    .container {
      position: relative;
      z-index: 1;
      width: 90%;
      max-width: 480px;
      backdrop-filter: blur(12px);
      background: var(--card);
      border-radius: 20px;
      border: 1px solid rgba(255, 77, 77, 0.3);
      box-shadow: 0 0 40px var(--primary-glow);
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .login-box, .panel { padding: 32px 24px; text-align: center; }

    .avatar {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      border: 4px solid var(--primary);
      box-shadow: 0 0 40px var(--primary-glow);
      object-fit: cover;
      margin-bottom: 24px;
      transition: transform 0.3s ease;
    }
    .avatar:hover { transform: scale(1.05); }

    h1 { font-size: 2rem; color: var(--primary); margin-bottom: 12px; text-shadow: 0 0 20px var(--primary-glow); }
    h2 { font-size: 1.5rem; color: var(--accent); margin-bottom: 20px; }

    .form-input {
      width: 100%;
      padding: 16px;
      margin: 16px 0;
      border: 1px solid rgba(255, 77, 77, 0.4);
      border-radius: 12px;
      background: rgba(20, 20, 20, 0.8);
      color: var(--text);
      font-size: 1.1rem;
      text-align: center;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .form-input:focus { border-color: var(--primary); box-shadow: 0 0 20px var(--primary-glow); outline: none; }

    .btn, .btn-link {
      width: 100%;
      padding: 16px;
      margin: 12px 0;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 25px rgba(230, 0, 0, 0.5);
      display: block;
      text-decoration: none;
      text-align: center;
    }
    .btn:hover:not(:disabled), .btn-link:hover { 
      transform: translateY(-3px) scale(1.01); 
      box-shadow: 0 12px 35px rgba(230, 0, 0, 0.7); 
    }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }

    .tabs {
      display: flex;
      margin: 24px 0 20px;
      border-radius: 12px;
      background: rgba(0,0,0,0.5);
      overflow-x: auto;
      white-space: nowrap;
    }
    .tab {
      flex: 1 0 auto;
      padding: 16px;
      color: var(--text-muted);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.35s;
      min-width: 80px;
    }
    .tab.active { background: var(--primary); color: white; box-shadow: inset 0 0 12px rgba(0,0,0,0.3); }

    .content { display: none; }
    .content.active { display: block; animation: fadeIn 0.5s ease; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

    label {
      display: flex;
      align-items: center;
      margin: 16px 0;
      font-size: 1rem;
      cursor: pointer;
      transition: color 0.3s;
    }
    label:hover { color: var(--accent); }
    input[type="checkbox"], input[type="radio"] {
      accent-color: var(--primary);
      margin-right: 14px;
      transform: scale(1.4);
    }

    select, input[type="range"] {
      width: 100%;
      padding: 14px;
      margin: 14px 0;
      border-radius: 12px;
      border: 1px solid rgba(255, 77, 77, 0.4);
      background: rgba(20, 20, 20, 0.8);
      color: var(--text);
      font-size: 1rem;
      transition: border-color 0.3s;
    }
    select:focus, input[type="range"]:focus { border-color: var(--primary); }

    input[type="range"] {
      height: 10px;
      -webkit-appearance: none;
      background: rgba(230, 0, 0, 0.2);
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px; height: 24px;
      border-radius: 50%;
      background: var(--primary);
      box-shadow: 0 0 20px var(--primary-glow);
      cursor: pointer;
    }

    .divider { height: 1px; background: rgba(255, 77, 77, 0.3); margin: 24px 0; }

    .toast {
      position: fixed;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.9);
      color: var(--primary);
      padding: 18px 35px;
      border-radius: 18px;
      font-weight: bold;
      z-index: 9999;
      opacity: 0;
      transition: all 0.5s ease;
      border: 1px solid var(--primary);
      box-shadow: 0 8px 25px rgba(0,0,0,0.6);
    }
    .toast.show { opacity: 1; bottom: 80px; }

    .color-btn {
      height: 60px;
      border-radius: 12px;
      cursor: pointer;
      border: 3px solid transparent;
      transition: border 0.35s, transform 0.25s;
    }
    .color-btn:hover { transform: scale(1.05); }

    .status-indicator {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--error);
      margin-left: 8px;
      transition: background 0.3s;
    }
    .status-indicator.active { background: var(--success); }

    @media (max-width: 480px) {
      .container { width: 95%; padding: 24px 18px; }
      .btn, .btn-link { font-size: 0.95rem; padding: 14px; }
      .tabs { font-size: 0.9rem; }
    }
  </style>
</head>
<body>

  <div id="particles-js"></div>

  <!-- Login -->
  <div class="container login-box" id="loginBox">
    <img src="https://i.postimg.cc/gcZd0K8g/description.webp" class="avatar" alt="Avatar do Project X Red" 
         onerror="this.src='https://via.placeholder.com/110?text=PXR'">
    <h1>HEADTRICK 2026</h1>
    <p style="color:var(--text-muted); font-weight:bold; margin:20px 0;">⚠️ KEY - 1 DISPOSITIVO / ANTI-BAN AVANÇADO</p>

    <input type="password" id="licenseKey" class="form-input" placeholder="XXXX-XXXX-XXXX" aria-label="Chave de Licença"/>
    <button class="btn" id="enterBtn">ENTRAR</button>
    <button class="btn" style="background:linear-gradient(135deg, #333, #555);" onclick="window.open('https://discord.gg/9jEQEHuk','_blank')">DISCORD OFICIAL</button>
  </div>

  <!-- Painel Principal -->
  <div class="container panel" id="mainPanel" style="display:none; max-height:95vh; overflow-y:auto;">
    <h2>PROJECT X RED v5.0 - OB52 A23</h2>
    <div class="divider"></div>

    <div class="tabs">
      <div class="tab active" data-tab="aimbot">Aimbot</div>
      <div class="tab" data-tab="extra">Extra</div>
      <div class="tab" data-tab="otimizacao">Otimização</div>
      <div class="tab" data-tab="config">Config</div>
      <div class="tab" data-tab="info">Info</div>
    </div>

    <div id="aimbot" class="content active">
      <label for="ativarAuxilio"><input type="checkbox" id="ativarAuxilio" checked> Ativar Auxílio<span class="status-indicator"></span></label>
      <label for="ativarFov"><input type="checkbox" id="ativarFov"> Ativar FOV Dinâmico</label>

      <div id="fovContainer" style="display:none; margin:20px 0;">
        <input type="range" min="40" max="200" value="90" id="fovRange" aria-label="Ajuste de FOV"/>
        <p>FOV Dinâmico: <strong id="fovValue">90°</strong></p>
      </div>

      <select id="auxType" aria-label="Tipo de Auxílio">
        <option selected>Auxílio Cabeça</option>
        <option>Auxílio Pescoço</option>
        <option>Auxílio Peito</option>
        <option>Auxílio Recoil</option>
      </select>

      <div id="strengthContainer" style="margin:20px 0;">
        <input type="range" min="0" max="100" value="50" id="assistStrength" aria-label="Força do Auxílio"/>
        <p>Assist Strength: <strong id="strengthValue">50%</strong></p>
      </div>

      <div style="margin:20px 0;">
        <input type="range" min="40" max="100" value="85" id="smoothnessRange" aria-label="Suavidade"/>
        <p>Smoothness: <strong id="smoothValue">85%</strong></p>
      </div>

      <div id="maxDistContainer" style="margin:20px 0;">
        <input type="range" min="10" max="500" value="100" id="maxLockDist" aria-label="Distância Máxima de Lock"/>
        <p>Max Lock Distance: <strong id="maxDistValue">100m</strong></p>
      </div>

      <div class="divider"></div>

      <p style="font-weight:bold; margin:16px 0 10px; color:var(--accent);">Trigger Avançado:</p>
      <label for="tipo-atirar"><input type="radio" id="tipo-atirar" name="tipo" value="atirar"> Ao Atirar (Preciso)</label>
      <label for="tipo-olhar"><input type="radio" id="tipo-olhar" name="tipo" value="olhar" checked> Ao Olhar/Mirar (Suave)</label>

      <button class="btn" id="ativarBtn">ATIVAR CONFIGURAÇÕES</button>

      <button class="btn btn-link" id="openFFBtn">ABRIR FREE FIRE + INJETAR ENGINE v5.0</button>

      <button class="btn" id="dnsAndroidBtn">AUXÍLIO DNS ANDROID</button>
      <button class="btn" id="dnsIphoneBtn">AUXÍLIO DNS IPHONE</button>
    </div>

    <div id="extra" class="content">
      <h2>Funções Extra</h2>
      <label for="antiPinadeira"><input type="checkbox" id="antiPinadeira" checked> Anti Pinadeira Avançada</label>
      <label for="antiTremedeira"><input type="checkbox" id="antiTremedeira" checked> Anti Tremedeira Avançada</label>
      <label for="fixarCabeca"><input type="checkbox" id="fixarCabeca"> Fixar na Cabeça Suavizado</label>
      <label for="autoHeadshot"><input type="checkbox" id="autoHeadshot"> Auto Headshot (Beta)</label>
      <label for="noRecoil"><input type="checkbox" id="noRecoil" checked> No Recoil Avançado</label>

      <button class="btn" id="ativarExtraBtn">ATIVAR FUNÇÕES EXTRA</button>
    </div>

    <div id="otimizacao" class="content">
      <h2>Otimização (Zero Lag - A23)</h2>
      <label for="limparCache"><input type="checkbox" id="limparCache" checked> Limpar Cache Profundo</label>
      <label for="fecharApps"><input type="checkbox" id="fecharApps" checked> Fechar Background Total</label>
      <label for="boostRAM"><input type="checkbox" id="boostRAM" checked> Boost RAM Máximo</label>
      <label for="otimizarBateria"><input type="checkbox" id="otimizarBateria" checked> Otimizar Bateria + Performance</label>
      <label for="reduzirLag"><input type="checkbox" id="reduzirLag" checked> Reduzir Lag de Rede</label>

      <div class="divider"></div>

      <p style="font-weight:bold; margin:16px 0 10px; color:var(--accent);">FPS:</p>
      <select id="fpsSelect" aria-label="Seleção de FPS">
        <option value="60">60 FPS Estável</option>
        <option value="90" selected>90 FPS Balanceado (A23 Recomendado)</option>
        <option value="120">120 FPS Máximo</option>
        <option value="144">144 FPS Extremo (Experimental)</option>
      </select>

      <button class="btn" id="aplicarOtimizacaoBtn">APLICAR OTIMIZAÇÃO A23</button>
    </div>

    <div id="config" class="content">
      <p style="margin-bottom:20px; font-weight:600; color:var(--accent);">Cor do Painel:</p>
      <div class="color-options" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:16px; margin:20px 0;">
        <div class="color-btn" style="background:#e60000;" data-color="#e60000" aria-label="Vermelho"></div>
        <div class="color-btn" style="background:#ff4d4d;" data-color="#ff4d4d" aria-label="Vermelho Claro"></div>
        <div class="color-btn" style="background:#b30000;" data-color="#b30000" aria-label="Vermelho Escuro"></div>
        <div class="color-btn" style="background:#ff5722;" data-color="#ff5722" aria-label="Laranja"></div>
        <div class="color-btn" style="background:#2196f3;" data-color="#2196f3" aria-label="Azul"></div>
        <div class="color-btn" style="background:#4caf50;" data-color="#4caf50" aria-label="Verde"></div>
        <div class="color-btn" style="background:#ffffff;" data-color="#ffffff" aria-label="Branco"></div>
        <div class="color-btn" style="background:#808080;" data-color="#808080" aria-label="Cinza"></div>
        <div class="color-btn" style="background:#000000;" data-color="#000000" aria-label="Preto"></div>
      </div>

      <div class="divider"></div>
      <button class="btn" id="saveConfigBtn">SALVAR CONFIGURAÇÕES</button>
      <button class="btn" id="loadConfigBtn" style="background: linear-gradient(135deg, #333, #555);">CARREGAR CONFIGURAÇÕES</button>
      <button class="btn" id="resetConfigBtn" style="background: linear-gradient(135deg, #f44336, #d32f2f);">RESETAR CONFIGURAÇÕES</button>
    </div>

    <div id="info" class="content">
      <p><b>Dispositivo:</b> <span id="modelo">—</span></p>
      <p><b>Key:</b> <span id="key">—</span></p>
      <p><b>ID:</b> <span id="deviceId">—</span></p>
      <p><b>Horário:</b> <span id="horario">—</span></p>
      <p><b>Região:</b> <span id="regiao">—</span></p>
      <p><b>Engine:</b> <span id="engineVersion">—</span></p>
      <div class="divider"></div>
      <p style="color:var(--primary); font-weight:bold;">Sistema Online ✓ Anti-Ban Level Pro - OB52</p>
      <p style="color:var(--text-muted); font-size:0.95rem; margin-top:16px;">
        Teste no treino antes de ranqueada. Use com inteligência.
      </p>
    </div>

    <!-- CÓDIGOS OCULTOS / PATTERNS DE MEMÓRIA - CONSOLIDADOS E APRIMORADOS -->
    <pre id="hiddenCodes" style="display:none" aria-hidden="true">

# =============================================================================
# PATTERNS DE MEMÓRIA - FREE FIRE OB52 / A23 (FEVEREIRO 2026)
# Project X Red v5.0 - FOCO TOTAL NO CRÂNIO + ESTABILIDADE ANTI-BAN AVANÇADA
# Consolidação de todos os patterns: priorizando headshot, com variantes
# Uso: Injetar via engine externa, GG ou internal cheat
# Atualização: Fevereiro 2026 - Mais estável contra detecção
# =============================================================================

# ─── Bone Targeting Principal - FORÇA TOTAL NO CRÂNIO ───────────────────────
# Cabeça principal (estável e comum)
HEAD_SEARCH         = 62 6F 6E 65 5F 48 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00 2F 63 20 41 31
HEAD_REPLACE        = 62 6F 6E 65 5F 48 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF

# Cabeça alternativa (minúsculo ou sufixo variado)
HEAD_ALT_SEARCH     = 62 6F 6E 65 5F 68 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00
HEAD_ALT_REPLACE    = 62 6F 6E 65 5F 48 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF

# ─── Neutraliza Fallbacks Ruins (força tudo para cabeça) ────────────────────
# Pescoço → Cabeça
NECK_SEARCH         = 62 6F 6E 65 5F 4E 65 63 6B 00 00 00 00 00 00 00 00 00 00 00 00 00 3D 34
NECK_REPLACE        = 62 6F 6E 65 5F 48 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF

# Peito → Cabeça (crítico para evitar tiros no corpo)
CHEST_SEARCH        = 62 6F 6E 65 5F 43 68 65 73 74 00 00 00 00 00 00 00 00 00 00 00 00 3D 34
CHEST_REPLACE       = 62 6F 6E 65 5F 48 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF

# Spine/Corpo → Cabeça
SPINE_SEARCH        = 62 6F 6E 65 5F 53 70 69 6E 65 00 00 00 00 00 00 00 00 00 00 00 00
SPINE_REPLACE       = 62 6F 6E 65 5F 48 65 61 64 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF

# ─── Magic Bullet / Headshot Forçado (compensa drop, mira baixa) ───────────
# Versão reforçada para headshot
MAGIC_HEADSHOT_SEARCH = C0 3F 33 33 93 3F 8F C2 F5 3C CD CC CC 3D ?? ?? ?? ?? EC 51 B8
MAGIC_HEADSHOT_REPLACE= C0 3F 33 33 93 3F 8F C2 F5 3C CD CC CC 3D 00 00 00 00 EC 51 B8 3D CD CC 4C 3F 00 00 00 00 00 00 C8 42 FF FF FF FF 80 3F 01

# Versão alternativa (bullet drop compensation geral)
MAGIC_BULLET_SEARCH   = C0 3F 33 33 93 3F 8F C2 F5 3C CD CC CC 3D ?? ?? ?? ?? EC 51 B8
MAGIC_BULLET_REPLACE  = C0 3F 33 33 93 3F 8F C2 F5 3C CD CC CC 3D 00 00 00 00 EC 51 B8 3D CD CC 4C 3F 00 00 00 00 00 00 A0 42 FF FF FF FF 80 3F 01

# ─── No Recoil Reforçado (mira grudada na cabeça pós-primeiro tiro) ────────
RECOIL_PATTERN_X_SEARCH = 00 00 00 00 00 00 00 00 15 6E 00 00 00 00 00 00 00 40 01 00
RECOIL_PATTERN_X_REPLACE= 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

RECOIL_PATTERN_Y_SEARCH = 00 00 00 00 00 00 00 00 FD 20 02 00 00 00 00 00 00 24 06 00
RECOIL_PATTERN_Y_REPLACE= 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

# Versão alternativa agressiva (zero recoil total)
RECOIL_PATTERN_X_ALT_REPLACE = 00 00 80 3F 00 00 80 3F 00 00 80 3F 00 00 80 3F 00 00 00 00 00 00 00 00
RECOIL_PATTERN_Y_ALT_REPLACE = 00 00 80 3F 00 00 80 3F 00 00 80 3F 00 00 80 3F 00 00 00 00 00 00 00 00

# ─── Prioridade Head no Sistema de Visibilidade/Lock ───────────────────────
HEAD_PRIORITY_SEARCH = 3F 80 00 00 ?? ?? ?? ?? 00 00 80 3F 00 00 00 00
HEAD_PRIORITY_REPLACE= 3F 80 00 00 FF FF FF 3F 00 00 80 3F 00 00 00 00   # Eleva prioridade da cabeça

# ─── Anti-Ban / Bypass Triggers (strings detectadas pelo anti-cheat) ───────
BAN_STRINGS = [
  "XH_REPORT_HACKKILL",
  "XH_MAILBOX_REPORT",
  "EVENT_TYPE_REPORT_CHEAT",
  "ANTIHACK_CLOSEWINDOW",
  "CHEAT_DETECTED",
  "MEMORY_MODIFY",
  "ILLEGAL_INJECTION",
  "HITREG_VIOLATION",
  "AIMBOT_FLAG",
  "TELEMETRY_ANOMALY",
  "SPEEDHACK_DETECT"
]

# ─── FPS Unlock / Frame Rate Bypass ────────────────────────────────────────
FPS_UNLOCK_SEARCH  = 3C 00 00 00 00 00
FPS_UNLOCK_REPLACE = 5A 00 00 00 00 00   # → \~144 FPS (experimental, use com cautela)

# ─── Outros (ESP, Wallhack - placeholders para expansão) ───────────────────
ESP_PLAYER_BOX_SEARCH   = ?? ?? ?? ?? F3 0F 10 05 ?? ?? ?? ?? 48 8B 05
ESP_PLAYER_BOX_REPLACE  = 90 90 90 90 90 90 90 90 90 90 90 90 90 90   # NOP para bypass

WALLHACK_VISIBLE_SEARCH = 00 00 80 3F ?? ?? ?? ?? 00 00 00 00
WALLHACK_VISIBLE_REPLACE= FF FF FF FF FF FF FF FF FF FF FF FF   # Visibilidade forçada

# =============================================================================
# Fim dos patterns para OB52 / A23 - 2026
# Dicas: Teste no modo treino. Atualize após cada update OB. Use com moderação para evitar ban.
# =============================================================================

    </pre>
  </div>

  <div class="toast" id="toast" role="alert" aria-live="assertive"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
  <script>
// =============================================
// PROJECT X RED v5.0 – Engine OB52 2026 – A23 Optimized
// Refatorado: Mais modular, eficiente e com melhor UX (Henrico - 2026)
// =============================================

const ENGINE_VERSION = "OB52-2026-A23-SUPER-OPT-V5.0";
let currentThemeColor = localStorage.getItem('px_theme_color') || "#e60000";

const defaultConfig = {
  aimbot: {
    active: false,
    enabled: true,
    fovEnabled: false,
    fov: 90,
    bone: "cabeca",
    strength: 50,
    smoothness: 85,
    maxDistance: 100,
    trigger: "olhar"
  },
  extras: {
    antiPinadeira: true,
    antiTremedeira: true,
    fixarCabeca: false,
    autoHeadshot: false,
    noRecoil: true
  },
  optimization: {
    limparCache: true,
    fecharApps: true,
    boostRAM: true,
    otimizarBateria: true,
    reduzirLag: true,
    fpsTarget: "90"
  },
  engineVersion: ENGINE_VERSION,
  isA23: false,
  themeColor: currentThemeColor
};

let config = { ...defaultConfig };

// ────────────────────────────────────────────────
//  UTILITÁRIOS APRIMORADOS
// ────────────────────────────────────────────────

function isA23Device() {
  const ua = navigator.userAgent.toLowerCase();
  return /sm-a235|galaxy a23/.test(ua) && /android/.test(ua);
}

function getPersistentDeviceId() {
  let id = localStorage.getItem("px_device_id_v5");
  if (!id) {
    id = "PX-" + Date.now().toString(36) + Math.random().toString(36).slice(2, 8).toUpperCase();
    localStorage.setItem("px_device_id_v5", id);
  }
  return id;
}

function getDeviceModelName() {
  const ua = navigator.userAgent;
  const androidMatch = ua.match(/Android [\d.]+; ([\w\s-]+) Build/);
  if (androidMatch) return androidMatch[1].trim();
  if (/iPhone/.test(ua)) return "iPhone";
  return "Desconhecido";
}

function showToast(msg, duration = 2800, type = 'info') {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.className = `toast show ${type}`;
  setTimeout(() => toast.className = 'toast', duration);
}

function applyThemeColor(hex) {
  currentThemeColor = hex;
  localStorage.setItem('px_theme_color', hex);
  const r = parseInt(hex.slice(1,3), 16);
  const g = parseInt(hex.slice(3,5), 16);
  const b = parseInt(hex.slice(5,7), 16);
  
  document.documentElement.style.setProperty('--primary', hex);
  document.documentElement.style.setProperty('--primary-glow', `rgba(\( {r}, \){g},${b},0.5)`);
  document.documentElement.style.setProperty('--accent', hex);

  if (window.pJSDom?.[0]?.pJS) {
    const p = window.pJSDom[0].pJS;
    p.particles.color.value = hex;
    p.particles.line_linked.color = hex;
    p.fn.particlesRefresh();
  }
}

function isValidLicenseKey(key) {
  return /^[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/i.test(key);
}

// ────────────────────────────────────────────────
//  CONFIG – LOCALSTORAGE APRIMORADA
// ────────────────────────────────────────────────

function saveUserConfig() {
  try {
    config.isA23 = isA23Device();
    config.engineVersion = ENGINE_VERSION;
    config.themeColor = currentThemeColor;
    localStorage.setItem('projectx_red_v50_ob52_a23', JSON.stringify(config));
    showToast("Configurações salvas com sucesso", 2200, 'success');
  } catch (err) {
    showToast("Erro ao salvar configurações", 3200, 'error');
    console.error("Falha saveConfig:", err);
  }
}

function loadUserConfig(silent = false) {
  try {
    const saved = localStorage.getItem('projectx_red_v50_ob52_a23');
    if (saved) {
      Object.assign(config, JSON.parse(saved));
      applyThemeColor(config.themeColor || "#e60000");
      updateUIFromConfig();
      if (!silent) showToast("Configurações restauradas", 2200, 'success');
    } else {
      showToast("Nenhuma config salva encontrada. Usando defaults.", 3200, 'warning');
    }
  } catch (err) {
    console.error("Erro ao carregar config:", err);
    showToast("Erro ao carregar config. Usando defaults.", 3200, 'error');
  }
}

function resetUserConfig() {
  localStorage.removeItem('projectx_red_v50_ob52_a23');
  config = { ...defaultConfig };
  applyThemeColor("#e60000");
  updateUIFromConfig();
  showToast("Configurações resetadas para default", 2200, 'warning');
}

function updateUIFromConfig() {
  // Aimbot
  document.getElementById('ativarAuxilio').checked = config.aimbot.enabled;
  document.getElementById('ativarFov').checked = config.aimbot.fovEnabled;
  document.getElementById('fovContainer').style.display = config.aimbot.fovEnabled ? 'block' : 'none';
  document.getElementById('fovRange').value = config.aimbot.fov;
  document.getElementById('fovValue').textContent = config.aimbot.fov + '°';

  const boneMap = {
    cabeca: 'Auxílio Cabeça',
    pescoco: 'Auxílio Pescoço',
    peito: 'Auxílio Peito',
    recoil: 'Auxílio Recoil'
  };
  document.getElementById('auxType').value = boneMap[config.aimbot.bone] || 'Auxílio Cabeça';

  document.getElementById('assistStrength').value = config.aimbot.strength;
  document.getElementById('strengthValue').textContent = config.aimbot.strength + '%';
  document.getElementById('smoothnessRange').value = config.aimbot.smoothness;
  document.getElementById('smoothValue').textContent = config.aimbot.smoothness + '%';
  document.getElementById('maxLockDist').value = config.aimbot.maxDistance;
  document.getElementById('maxDistValue').textContent = config.aimbot.maxDistance + 'm';

  document.querySelector(`input[name="tipo"][value="${config.aimbot.trigger}"]`).checked = true;

  // Extras
  Object.entries(config.extras).forEach(([key, val]) => {
    const el = document.getElementById(key);
    if (el) el.checked = val;
  });

  // Otimização
  Object.entries(config.optimization).forEach(([key, val]) => {
    if (key === 'fpsTarget') {
      document.getElementById('fpsSelect').value = val;
    } else {
      const el = document.getElementById(key);
      if (el?.type === 'checkbox') el.checked = val;
    }
  });

  // Tema
  document.querySelectorAll('.color-btn').forEach(btn => {
    btn.style.border = (btn.dataset.color === config.themeColor) ? '3px solid white' : '3px solid transparent';
  });

  document.getElementById('engineVersion').textContent = config.engineVersion || "—";
  updateAimbotToggleButton();
}

// ────────────────────────────────────────────────
//  SIMULAÇÃO DE INJEÇÃO (MELHORADA COM LOADER)
// ────────────────────────────────────────────────

function simulateEngineInjection(callback) {
  const isA23 = isA23Device();
  showToast(isA23 ? "Injetando engine otimizada para A23..." : "Injetando Engine v5.0...", 3800, 'warning');

  // Simula loader
  const loaderInterval = setInterval(() => {
    showToast("Injetando... " + Math.floor(Math.random() * 100) + "%", 1000, 'warning');
  }, 800);

  setTimeout(() => {
    clearInterval(loaderInterval);
    const successChance = isA23 ? 0.98 : 0.88; // Aumentei chance para A23
    if (Math.random() < successChance) {
      const compat = Math.floor(90 + Math.random() * 10);
      showToast(`Engine OB52 v5.0 injetada com sucesso (${compat}% compatibilidade)`, 5200, 'success');
      
      document.querySelectorAll('.status-indicator').forEach(ind => {
        ind.classList.add('active');
        ind.style.background = '#4caf50';
        ind.style.boxShadow = '0 0 20px #4caf50';
      });
      if (callback) callback(true);
    } else {
      showToast("Falha na injeção – possível detecção pelo anti-cheat", 6500, 'error');
      setTimeout(() => {
        document.getElementById('mainPanel').style.display = 'none';
        document.getElementById('loginBox').style.display = 'block';
      }, 2800);
      if (callback) callback(false);
    }
  }, isA23 ? 1500 : 2500);
}

// ────────────────────────────────────────────────
//  UI – ATUALIZAÇÕES
// ────────────────────────────────────────────────

function updateAimbotToggleButton() {
  const btn = document.getElementById('ativarBtn');
  if (config.aimbot.active) {
    btn.textContent = 'DESATIVAR HEADTRICK';
    btn.style.background = 'linear-gradient(135deg, #f44336, #d32f2f)';
  } else {
    btn.textContent = 'ATIVAR HEADTRICK';
    btn.style.background = 'linear-gradient(135deg, var(--primary), var(--accent))';
  }
}

// ────────────────────────────────────────────────
//  ABRIR FREE FIRE – TENTATIVA INTELIGENTE
// ────────────────────────────────────────────────

async function attemptLaunchFreeFire() {
  const schemes = [
    'freefire://',
    'ff://',
    'com.dts.freefireth://',
    'garena-free-fire://',
    'freefiremax://'
  ];

  for (const scheme of schemes) {
    const startTime = Date.now();
    window.location.href = scheme;
    await new Promise(r => setTimeout(r, 700));

    if (document.hidden || Date.now() - startTime > 900) {
      return true;
    }
  }

  showToast("Não foi possível abrir o Free Fire. Verifique se o app está instalado.", 4800, 'warning');
  return false;
}

// ────────────────────────────────────────────────
//  EVENT LISTENERS – CENTRALIZADOS E APRIMORADOS
// ────────────────────────────────────────────────

document.addEventListener('DOMContentLoaded', () => {
  // Tabs navigation
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.tab, .content').forEach(el => el.classList.remove('active'));
      tab.classList.add('active');
      document.getElementById(tab.dataset.tab).classList.add('active');
    });
  });

  // ─── Aimbot Controls ───
  document.getElementById('ativarAuxilio').addEventListener('change', e => {
    config.aimbot.enabled = e.target.checked;
  });

  document.getElementById('ativarFov').addEventListener('change', e => {
    config.aimbot.fovEnabled = e.target.checked;
    document.getElementById('fovContainer').style.display = e.target.checked ? 'block' : 'none';
  });

  document.getElementById('fovRange').addEventListener('input', e => {
    config.aimbot.fov = Number(e.target.value);
    document.getElementById('fovValue').textContent = e.target.value + '°';
  });

  document.getElementById('assistStrength').addEventListener('input', e => {
    config.aimbot.strength = Number(e.target.value);
    document.getElementById('strengthValue').textContent = e.target.value + '%';
  });

  document.getElementById('smoothnessRange').addEventListener('input', e => {
    config.aimbot.smoothness = Number(e.target.value);
    document.getElementById('smoothValue').textContent = e.target.value + '%';
  });

  document.getElementById('maxLockDist').addEventListener('input', e => {
    config.aimbot.maxDistance = Number(e.target.value);
    document.getElementById('maxDistValue').textContent = e.target.value + 'm';
  });

  document.getElementById('auxType').addEventListener('change', e => {
    const value = e.target.value.toLowerCase().replace(/auxílio\s*/i, '').replace('ç', 'c');
    config.aimbot.bone = value;
  });

  document.querySelectorAll('input[name="tipo"]').forEach(radio => {
    radio.addEventListener('change', () => {
      config.aimbot.trigger = radio.value;
    });
  });

  // ─── Extras & Otimização ───
  document.querySelectorAll('#extra input[type="checkbox"], #otimizacao input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', e => {
      const section = checkbox.closest('.content').id;
      const group = section === 'extra' ? 'extras' : 'optimization';
      config[group][checkbox.id] = e.target.checked;
    });
  });

  document.getElementById('fpsSelect')?.addEventListener('change', e => {
    config.optimization.fpsTarget = e.target.value;
  });

  // ─── Botões Principais ───
  document.getElementById('ativarBtn').addEventListener('click', () => {
    config.aimbot.active = !config.aimbot.active;
    updateAimbotToggleButton();

    if (config.aimbot.active) {
      if (isA23Device()) {
        config.aimbot.smoothness = Math.max(35, Math.floor(config.aimbot.smoothness * 0.93));
        document.getElementById('smoothValue').textContent = config.aimbot.smoothness + '%';
      }
      simulateEngineInjection();
      showToast(`HEADTRICK ATIVADO • ${config.aimbot.bone.toUpperCase()} • ${config.aimbot.strength}%`, 3400, 'success');
    } else {
      showToast('HEADTRICK DESATIVADO', 3000, 'error');
    }
  });

  document.getElementById('openFFBtn').addEventListener('click', async function() {
    this.disabled = true;
    this.textContent = 'INJETANDO + ABRINDO FREE FIRE...';
    
    simulateEngineInjection(async (success) => {
      if (success) await attemptLaunchFreeFire();
      this.textContent = 'ABRIR FREE FIRE + INJETAR ENGINE v5.0';
      this.disabled = false;
    });
  });

  document.getElementById('ativarExtraBtn').addEventListener('click', () => {
    const activeExtras = Object.entries(config.extras)
      .filter(([, active]) => active)
      .map(([name]) => name.replace(/([A-Z])/g, ' $1').trim().toUpperCase());
    
    showToast(
      activeExtras.length ? activeExtras.join(' + ') + " ATIVOS" : "Nenhum extra selecionado",
      4200,
      activeExtras.length ? 'success' : 'warning'
    );
  });

  document.getElementById('aplicarOtimizacaoBtn').addEventListener('click', () => {
    const applied = Object.entries(config.optimization)
      .filter(([key, value]) => value && key !== 'fpsTarget')
      .map(([key]) => key.replace(/([A-Z])/g, ' $1').trim().toUpperCase());
    showToast(
      `OTIMIZAÇÃO A23 APLICADA • ${applied.join(' + ') || 'Nenhum'} • ${config.optimization.fpsTarget} FPS`,
      4000,
      'success'
    );
  });

  ['dnsAndroidBtn', 'dnsIphoneBtn'].forEach(id => {
    document.getElementById(id)?.addEventListener('click', () => {
      const device = id.includes('Android') ? 'Android' : 'iPhone';
      showToast(`DNS ${device} configurado com sucesso!`, 2400, 'success');
    });
  });

  document.getElementById('saveConfigBtn').addEventListener('click', saveUserConfig);
  document.getElementById('loadConfigBtn').addEventListener('click', () => loadUserConfig(false));
  document.getElementById('resetConfigBtn').addEventListener('click', resetUserConfig);

  // Cores do tema
  document.querySelectorAll('.color-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.color-btn').forEach(b => b.style.border = '3px solid transparent');
      btn.style.border = '3px solid white';
      applyThemeColor(btn.dataset.color);
      showToast('Tema atualizado', 1600, 'success');
    });
  });

  // ─── Login Aprimorado ───
  document.getElementById('enterBtn').addEventListener('click', async () => {
    const input = document.getElementById('licenseKey');
    const key = input.value.trim().toUpperCase();

    if (!isValidLicenseKey(key)) {
      showToast('Formato inválido → use XXXX-XXXX-XXXX', 3400, 'error');
      input.focus();
      return;
    }

    document.getElementById('loginBox').style.display = 'none';
    document.getElementById('mainPanel').style.display = 'block';

    // Preenche informações do sistema
    document.getElementById('key').textContent = key;
    document.getElementById('deviceId').textContent = getPersistentDeviceId();
    document.getElementById('modelo').textContent = getDeviceModelName();
    document.getElementById('engineVersion').textContent = ENGINE_VERSION;

    // Relógio atualizado a cada segundo para precisão
    const timeEl = document.getElementById('horario');
    const updateClock = () => {
      timeEl.textContent = new Date().toLocaleTimeString('pt-BR', { hour12: false });
    };
    updateClock();
    setInterval(updateClock, 1000);

    // Região via IP (fallback se falhar)
    try {
      const geo = await fetch('https://ipapi.co/json/').then(r => r.json());
      document.getElementById('regiao').textContent = `\( {geo.country_name || '?'} ( \){geo.region || '?'})`;
    } catch {
      document.getElementById('regiao').textContent = "Indisponível";
    }

    if (isA23Device()) {
      showToast("Dispositivo Galaxy A23 detectado – otimizações especiais aplicadas", 4200, 'success');
    }

    loadUserConfig(true);
    showToast('Sessão iniciada – Engine v5.0 OB52 carregada', 4800, 'success');
  });

  document.getElementById('licenseKey').addEventListener('keypress', e => {
    if (e.key === 'Enter') document.getElementById('enterBtn').click();
  });

  // Inicialização de partículas (otimizada para mobile)
  const isMobile = /Mobi|Android/i.test(navigator.userAgent);
  particlesJS('particles-js', {
    particles: {
      number: { value: isMobile ? 30 : 50 },
      color: { value: currentThemeColor },
      opacity: { value: 0.6 },
      size: { value: 3 },
      line_linked: { enable: true, distance: 120, color: currentThemeColor, opacity: 0.4, width: 1 },
      move: { enable: true, speed: isMobile ? 1.8 : 2.4 }
    },
    interactivity: { events: { onhover: { enable: false } } }
  });

  // Tema inicial
  applyThemeColor(currentThemeColor);
  document.querySelector(`.color-btn[data-color="${currentThemeColor}"]`).style.border = '3px solid white';

  // Carrega config inicial
  loadUserConfig(true);
});

// Registro PWA (opcional, aprimorado)
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').catch(err => console.warn('Service Worker falhou:', err));
}
  </script>

</body>
    </html>
